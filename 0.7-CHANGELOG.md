# Warden 0.7 Changelog

## [0.7.0] - In Development

### Removed
- **Complete Spotlight Integration Removal** (2025-11-18)
  - Deleted `SpotlightIndexManager.swift` utility class
  - Removed CoreSpotlight framework import
  - Removed all Spotlight indexing and search handling from:
    - `ChatStore.swift` - removed indexing methods and background indexing task
    - `WardenApp.swift` - removed Spotlight search handler and user activity continuation
    - `ContentView.swift` - removed Spotlight notification listener and indexing on new chat creation
    - UI Files - removed pre-deletion indexing calls from:
      - `ProjectSummaryView.swift`
      - `ChatListRow.swift`
      - `ProjectListView.swift` (2 locations)
  - Removed `spotlightIndexingEnabled` attributes from Core Data model (3 references)
  - Cleaned Xcode project file references (project.pbxproj)
  - **Impact**: Reduces app bundle size, eliminates CoreSpotlight dependency, removes background indexing overhead
  - **No user-facing feature loss**: Spotlight was internal-only functionality

### Changed
- **Model Selector UI Reorganization** (2025-11-18)
   - Moved Favorites and Recently Used sections inside the dropdown (from separate toolbar buttons)
   - Removed `FavoriteQuickAccessBar` component from toolbar
   - Removed All/Favorites filter toggle buttons from dropdown header
   - Eliminated `showOnlyFavorites` state variable
   - Sections now display at top of dropdown when not searching
   - Cleaner, more focused UI with all model selection in one dropdown
   - **Files Changed**: `ModelSelectorDropdown.swift`, `ChatView.swift`

- **Model Pricing Implementation** (2025-11-18)
    - Added live pricing fetch from OpenRouter API (`/api/v1/models` endpoint)
    - Implemented provider-specific fetchers: OpenAI, Anthropic, Gemini, Mistral, xAI, Perplexity, DeepSeek
    - Self-hosted providers (Groq, Ollama, LMStudio) default to free tier
    - Pricing displays in model tooltip: `$0.001/1M` format with cost level indicators (`$`/`$$`/`$$$`)
    - Added staleness tracking (warns if metadata >30 days old)
    - Source attribution (API vs documentation)
    - **Files Changed**: `ModelMetadata.swift` (added pricing constants), `ModelMetadataFetcher.swift` (complete rewrite)

- **Model Selector Performance & UI Enhancements** (2025-11-18)
    - Added pricing display directly in dropdown model rows (cost indicator + price per 1M tokens)
    - Added pricing display in model selection settings view for transparency
    - **Performance Optimizations**:
      - Pre-calculate model scores in single pass before sorting (eliminated recalculation during sort)
      - Cache search text lowercasing (avoid repeated string transformations)
      - Pre-calculate metadata, favorite status, and model type flags in `modelRow` (eliminated multiple lookups per row)
      - Early exit in score calculation (skip recency check if model is already favorited)
      - Similar optimization applied to `ModelSelectionRow` in settings
    - **Impact**: Significantly faster rendering when scrolling through 100+ models, reduced memory allocations
    - **Files Changed**: `ModelSelectorDropdown.swift`, `ModelSelectionView.swift`

### Fixed

### Notes
- Verified build succeeds after removal (Cmd+B âœ“)
- Zero remaining Spotlight references in codebase verified
- All Core Data model spotlightIndexingEnabled attributes removed
- Project builds without CoreSpotlight dependency

---

**Status**: Actively adding more changes. See 0.7-ROADMAP.md for planned features.
